{"cells":[{"kind":2,"language":"SQL++","value":"SELECT VALUE\r\n    {\r\n        c.body,\r\n        c.createdAt,\r\n        c.id,\r\n        \"author\" : {\r\n            author.bio,\r\n            author.image,\r\n            \"username\": c.authorUsername,\r\n            \"following\": ARRAY_CONTAINS(COALESCE(follow,[]), c.authorUsername)\r\n        }\r\n    }\r\n\r\nFROM Conduit._default.Comments c2\r\nUSE KEYS \"OjeIfc7nudAW::comments\"\r\nUNNEST c2 AS c\r\nJOIN Conduit._default.Users author ON c.authorUsername = META(author).id\r\n\r\n/* join to the logged in user if not anonymous */\r\n/* parameterized with logged in username */\r\nLEFT JOIN Conduit._default.Follows follow ON (\"mgroves\" || \"::follows\") = META(follow).id\r\n\r\n\r\n"}]}